(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{15:function(t,e,n){},17:function(t,e,n){},18:function(t,e,n){"use strict";n.r(e);var c=n(1),r=n(0),u=n.n(r),a=n(9),i=n.n(a),o=(n(15),n(8)),s=n(3),l=n.n(s),f=n(6),b=n(2);n(17);var j=function(){var t=Object(r.useRef)(),e=Object(r.useState)(null),n=Object(b.a)(e,2),u=n[0],a=n[1],i=Object(r.useState)(null),s=Object(b.a)(i,2),j=s[0],d=s[1],h=Object(r.useState)(!1),p=Object(b.a)(h,2),O=p[0],v=p[1],x=Object(r.useState)(null),g=Object(b.a)(x,2),m=g[0],w=g[1],k=Object(r.useState)([]),y=Object(b.a)(k,2),C=y[0],S=y[1],N=Object(r.useState)([]),R=Object(b.a)(N,2),M=R[0],B=R[1],D=function(){var t=Object(f.a)(l.a.mark((function t(e){var n,c,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return v(!0),t.next=3,fetch("/upload",{method:"POST",body:e.target.files[0]});case 3:return n=t.sent,t.next=6,n.json();case 6:c=t.sent,r=c.filename,console.log("has filename",r),v(!1),d(r),e.preventDefault();case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();Object(r.useEffect)((function(){if(j){v(!0);var e=new Image;e.src=C.length>0?"".concat("","/composition/").concat(j,"?boxes=").concat(JSON.stringify(C),"&width=").concat(t.current.width):"".concat("","/static/uploads/").concat(j),e.decoding="async",e.decode().then((function(){a(e),v(!1)}))}}),[j,C]);var E=function(e,n){var c=t.current.getBoundingClientRect();return{x:e-c.left,y:n-c.top}},F=Object(r.useCallback)(function(){var e=Object(f.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.current.width=t.current.clientWidth,t.current.height=t.current.clientWidth/u.width*u.height,n.drawImage(u,0,0,t.current.clientWidth,t.current.clientHeight);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[u]),I=Object(r.useCallback)((function(t){C.map((function(e,n){var c=Object(b.a)(e,4),r=c[0],u=c[1],a=c[2],i=c[3];return!!M[n]&&(t.strokeStyle="blue",t.strokeRect(r,u,a,i),!0)}))}),[C,M]),J=Object(r.useCallback)(function(){var e=Object(f.a)(l.a.mark((function e(n){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n||t.current){e.next=2;break}return e.abrupt("return");case 2:(c=null!==n&&void 0!==n?n:t.current.getContext("2d")).clearRect(0,0,t.current.width,t.current.height),F(c,u),I(c);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[u,F,I]);Object(r.useEffect)((function(){J()}),[J,C,M]);var P=Object(r.useRef)([0,0,0,0]);return Object(c.jsxs)("div",{className:"page",children:[Object(c.jsx)("input",{id:"upload",onChange:D,type:"file"}),O&&Object(c.jsx)("div",{className:"loader"}),u&&Object(c.jsx)("canvas",{className:"canvas",onMouseDown:function(e){var n=t.current.getContext("2d");w(n);var c=E(e.clientX,e.clientY);P.current=[c.x,c.y,0,0]},onMouseUp:function(t){w(null),S((function(t){return[].concat(Object(o.a)(t),[P.current])})),B((function(t){return[].concat(Object(o.a)(t),[!0])}))},onMouseMove:function(t){if(m){J(m);var e=Object(b.a)(P.current,2),n=e[0],c=e[1],r=E(t.clientX,t.clientY),u=r.x-n,a=r.y-c;m.strokeStyle="blue",m.strokeRect(n,c,u,a),P.current=[n,c,u,a]}},ref:t}),Object(c.jsx)("div",{className:"sidebar",children:M.map((function(t,e){return Object(c.jsxs)("div",{className:"row",children:[Object(c.jsxs)("p",{children:["Box ",e]}),"Enabled?",Object(c.jsx)("input",{type:"checkbox",checked:t,onChange:function(){return function(t){var e=M.map((function(e,n){return n===t?!e:e}));B(e),J()}(e)}}),Object(c.jsx)("button",{onClick:function(){return function(t){S(C.map((function(e,n){return t!==n&&e})).filter((function(t){return t}))),B(M.map((function(e,n){return t===n?null:e})).filter((function(t){return null!==t})))}(e)},children:"Delete"})]})}))})]})},d=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,19)).then((function(e){var n=e.getCLS,c=e.getFID,r=e.getFCP,u=e.getLCP,a=e.getTTFB;n(t),c(t),r(t),u(t),a(t)}))};i.a.render(Object(c.jsx)(u.a.StrictMode,{children:Object(c.jsx)(j,{})}),document.getElementById("root")),d()}},[[18,1,2]]]);
//# sourceMappingURL=main.759592da.chunk.js.map